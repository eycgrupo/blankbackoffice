<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views https://axelor.com/xml/ns/object-views/object-views_6.1.xsd">

<grid name="pagos-grid" title="Lista de pagos"  model="com.eyc.base.db.Pago">
    <field name="fecha" />
    <field name="tipoPago" />
    <field name="tipoMoneda" />
    <field name="monto" aggregate="sum" />
    <field name="montoOriginal" aggregate="sum" />
    <field name="consolidado" />
</grid>

<form name="pagos-form" title="pago"  model="com.eyc.base.db.Pago"
    onNew="esconder-mostrar-numero-documento,colocar-fecha-por-omision-en-pagos" 
    onSave="validar-monto-pago">
   <panel title="Datos del pago">
       <field name="fecha" colSpan="12"  />
       <field name="tipoPago" colSpan="06" 
           onChange="validar-tipo-documento" />
       <field name="numeroDocumento" colSpan="06"  />
       <field name="tipoMoneda" colSpan="03" />  
       <field name="montoOriginal" hidden="true" />
       <field name="monto" colSpan="06" 
        onChange="chequear-monto-pago-mayor-cero" /> 
       <field name="consolidado" colSpan="03" widget="BooleanSwitch" />
  </panel>
</form>

<!-- groovy es un lenguaje script en JAVA -->
<action-record name="colocar-fecha-por-omision-en-pagos"
     model="com.eyc.base.db.Pago">
     <field name="fecha" expr="eval: __date__" />
</action-record>

<action-condition name="chequear-monto-pago-mayor-cero">
  <check field="createDate" if="monto &gt; 0"
    error="ERROR SI FUNCIONA "/>
</action-condition>

<action-validate name="validar-monto-pago">
   <error message="Saldo no puede ser negativo" if="monto &lt; 0" />
   <error message="Saldo no puede ser cero" if="monto == 0" />
 </action-validate>

 <action-attrs name="esconder-mostrar-numero-documento" >
    <attribute for="numeroDocumento" name="hidden" 
        expr="eval: (tipoPago == 'efectivo') ? true: false" /> 
       
 </action-attrs>
<!-- 
 <action-attrs name="cambiar-titulo-numero-documento" >
    <attribute for="numeroDocumento" name="title" 
       expr="eval: (tipoPago == 'tarjeta') ? 'Número de tarjeta' : (tipoPago == 'cheque') ?  'Numero de cheque' : ''"/> 
 </action-attrs>
 -->

 <action-attrs name="cambiar-titulo-numero-documento" >
    <attribute for="numeroDocumento" name="title"  expr="eval:'Número de tarjeta'" 
     if="tipoPago == 'tarjeta'"/> 
     <attribute for="numeroDocumento" name="title"  expr="eval:'Número de cheque'" 
     if="tipoPago == 'cheque'"/> 
      <attribute for="numeroDocumento" name="title"  expr="eval:''" 
     if="tipoPago == 'efectivo'"/> 
 </action-attrs>


<action-group name="validar-tipo-documento">
  <action name="esconder-mostrar-numero-documento" />
  <action name="cambiar-titulo-numero-documento" />
</action-group>

</object-views>